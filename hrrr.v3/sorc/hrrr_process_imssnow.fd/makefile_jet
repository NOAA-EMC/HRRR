# makefile for nssl_porcess
#! /bin/sh -v

# Define the fortran compiler and options

WRFDIR=/pan2/projects/nrtrr/alexander/code/rap/primary/RR-svn/trunk/WRFV3.6
UNGRIBDIR=/mnt/pan2/projects/nrtrr/alexander/code/rapidrefresh/rapid-refresh/WPSV3.9/ungrib/src
UPPLIBDIR=/pan2/projects/nrtrr/alexander/code/rap/primary/RR-svn/trunk/unipost/comupp/lib
NETCDF=/apps/netcdf/3.6.3-intel

FC   =  mpif90 -free -f90=ifort
#FLAGS= -O3 -fp-model precise -assume byterecl -fpe0 -g -traceback $(LDFLAGS) -DLINUX ## -convert big_endian
FLAGS= -O3 -g -traceback 

G2_INC4     = -I${UNGRIBDIR}/ngl/g2
G2_LIB4     = -L${UNGRIBDIR}/ngl/g2 -lg2_4
JASPER_LIB  = -L/usr/lib64 -ljasper
PNG_LIB     = -L/usr/lib64 -lpng
Z_LIB       = -L/usr/lib64 -lz

INCLD=  -I${NETCDF}/include -I../../../include ${G2_INC4}

LIBS =  \
        ${G2_LIB4} ${JASPER_LIB} ${PNG_LIB} ${Z_LIB} \
        -L${WRFDIR}/external/io_netcdf -lwrfio_nf \
        -L${NETCDF}/lib -lnetcdf \
        -L${UNGRIBDIR}/ngl/w3 -lw3 -L${UPPLIBDIR} -lip -lsp #-lw3nco -lw3emc

OBJS = grib2_read_mod.o process_NESDIS_imssnow.o netCDFsub_geo.o update_SNOWICE_netcdf_mass.o

all: process_NESDIS_imssnow

process_NESDIS_imssnow: ${OBJS}
	${FC} -o process_NESDIS_imssnow.exe ${FLAGS} ${OBJS} ${LIBS} 

.SUFFIXES : .F90 .f90 .o

.F90.o :
	${FC} ${FLAGS} ${INCLD} -c $<

.f90.o :
	${FC} ${FLAGS} ${INCLD} -c $<

clean:
	/bin/rm -f *.o *.exe *.mod
